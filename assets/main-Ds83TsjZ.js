import{r as c,C as m,j as e,F as j,f as u,a as f,b as N,c as C,d as b,A as g,N as P,e as v,L as w,g as M,h as y}from"./Loader-DtutB0et.js";const D=n=>{const[a,o]=c.useState(n.projects),{setMenuButtons:r}=c.useContext(m);async function p(t){confirm("Really delete this project?")&&(await C(t),o(a.filter(s=>s.id!=t)))}function h(t){return t.flatMap(s=>s.parts).reduce((s,i)=>s+i.notes.length,0)}function x(t,s){t.preventDefault(),r([{icon:f,text:"Open",onClick:()=>location.href=`/musixer/project/?id=${s}`},{icon:N,text:"Delete",onClick:()=>p(s)}])}return e.jsx("div",{className:"gap-4 border-b",children:a.map(({id:t,name:s,description:i,tracks:d})=>e.jsxs("div",{className:"border-t p-4 flex gap-4 items-center justify-between",onContextMenu:l=>x(l,t),children:[e.jsx("a",{className:"text-2xl w-96 hover:underline",href:`/musixer/project/?id=${t}`,children:s}),e.jsx("p",{className:"grow",children:i}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"text-sm text-neutral-400",children:[e.jsxs("p",{children:[d.length," tracks"]}),e.jsxs("p",{children:[h(d)," notes"]})]}),e.jsx(j,{icon:u,className:"btn-icon",onClick:l=>x(l,t)})]})]},t))})},$=()=>{const[n,a]=c.useState(!1);async function o(){try{a(!0);const r=await y();location.href=`/musixer/project/?id=${r.id}`}catch(r){console.error(r),alert("Failed to create project :("),a(!1)}}return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:"Dashboard - Musixer"}),e.jsx(P,{children:"Dashboard"}),e.jsxs("main",{className:"p-4",children:[e.jsxs("div",{className:"flex gap-8 items-center mb-4",children:[e.jsx("h1",{className:"text-4xl",children:"Projects"}),e.jsxs("button",{className:"btn h-fit",onClick:o,disabled:n,children:[e.jsx(j,{icon:v,className:"mr-2"}),n?"Creating...":"New Project"]})]}),e.jsx(w,{load:()=>M(),render:r=>e.jsx(D,{projects:r})})]})]})};b.createRoot(document.body).render(e.jsx(c.StrictMode,{children:e.jsx(g,{children:e.jsx($,{})})}));
